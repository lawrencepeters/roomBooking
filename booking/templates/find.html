{% extends "base_generic.html" %}

{% block content %}

<div class="container-fluid">
  <div class="panel panel-default">
    <div class="panel-heading"><h2 class="text-center">{{ displaydate }}</h2></div>
    <div class="panel-body">

        <table class="table table-hover" style="width:100%">
            <tr>
                <th>Date</th>
                <th>Room</th>
                <th>Period</th>
                <th>Facilities</th>
                <th>Facilities Match</th>
                <th>Book<th>
            </tr>
            {% for findRoom in findRooms %}
                <tr>
                    <td>{{ findRoom.bookDate }}</td> 
                    <td>{{ findRoom.room.roomName }}</td>
                    <td>{{ findRoom.period.periodName }}</td>
                    <td>
                        {% for facility in findRoom.facilities %}
                           <span class="label label-default">{{ facility.facilityName }}</span>
                        {% endfor %}    
                    </td> 
                    <td>{{ findRoom.percentageMatch }}%</td>
                    {% if findRoom.isBooked > 0 %}
                        <td><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></td>
                    {% else %}
                        <td><a href="#" onclick="doBook(this, '{{ bookingDate }}', '{{ findRoom.room.roomID }}', '{{ findRoom.period.periodID }}' )"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></a></td>
                    {% endif %}
                </tr>
            {% endfor %}
        </table>

        </div>
    <div class="panel-footer">
    </div>
</div>
</div>
<script>
function doBook(aObj, bookingDate, roomID, periodID) {

    csrftoken = getCookie('csrftoken');
    $.post("/booking/bookARoom",
    {
        csfrmiddlewaretoken: csrftoken,
        bookDate: bookingDate,
        periodID: periodID,
        roomID: roomID
    },
    function(data, status){
        $(aObj).parent().html('<span class="glyphicon glyphicon-remove" aria-hidden="true">');
    });
}
</script>

{% endblock %}